
<html
<body>

<script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
<script src="sleepless.js"></script>
<script src="mvc.js"></script>


<input type=text data-key="title" ><br>
<textarea placeholder="Description"></textarea><br>
<input type=number id="age" ><br>
<select name=flavor>
	<option></option>
	<option>Foo</option>
	<option>Bar</option>
</select><br>
Are you happy? <input type=checkbox title="Are you happy?" ><br>

Radio Station: 
	<input type=radio name="Station" station value=WKRP> WKRP
	&nbsp;&nbsp;&nbsp;
	<input type=radio name="Station" station value=KUOW> KUOW
	&nbsp;&nbsp;&nbsp;
	<input type=radio name="Station" station value=KCRAP> KCRAP

<p>
Organs:
	<input type=checkbox name="organs.kidney"> Kidney 
	&nbsp;
	<input type=checkbox name="organs.lung"> Lung 
	&nbsp;
	<input type=checkbox data-key="organs.heart"> Heart 

<p>
Pets:<br>
Dogs:
	<input type=checkbox name="pets.dogs.spot"> Spot 
	&nbsp;
	<input type=checkbox name="pets.dogs.rover"> Rover 
	<br>
Cats:
	<input type=checkbox name="pets.cats.mittens"> Mittens 
	&nbsp;
	<input type=checkbox name="pets.cats.stink"> Stink 
	<br>

<p>
Date: <input type=text data=isdate name="a_date">
<hr>

<script>

	MVC.set_data_keys();

	var data = {
		/*
		title: "",
		description: "",
		age: 0,
		flavor: "",
		are_you_happy: false,
		station: "",
		organs: {
			kidney: false,
			lung: false,
			heart: false,
		},
		pets: {
			dogs: { spot: false, rover: false, },
			cats: { mittens: false, stink: false, },
		},
		a_date: "",
		*/
		glorp: 7,
	};


	// coming out of model, and going into UI
	set_hook = function(e, v) {
		log("set_hook: v="+v+" data-key="+$(e).attr("data-key"));
		if($(e).attr("data") == "isdate") {
			return ts2us_mdy(v);
		}
		return v;
	}

	// coming out of UI, and going into model
	get_hook = function(e, v) {
		log("get_hook: v="+v+" data-key="+$(e).attr("data-key"));
		if($(e).attr("data") == "isdate") {
			return us2ts(v);
		}
		return v;
	}

	load = function() {
		data = JSON.parse(localStorage.getItem("data"));
		MVC.tie(data, set_hook, get_hook);
	}

	save = function() {
		var json = JSON.stringify(data);
		localStorage.setItem("data", json);
		log("saved: "+json);
	}

	MVC.tie(data, set_hook, get_hook);

</script>

<input type=button value=Load onclick="load()">
<input type=button value=Save onclick="save()">

